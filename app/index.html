<!DOCTYPE html>
<html ng-app="nem">
  <head>
    <meta charset="UTF-8">
    <title>Nem</title>
    <script src="../node_modules/angular/angular.js"></script>
    <script src="../node_modules/angular-hotkeys/build/hotkeys.js"></script>
    <link rel="stylesheet" type="text/css" href="../node_modules/angular-hotkeys/build/hotkeys.css">
    <link rel="stylesheet" href="css/photon.css">
    <link rel="stylesheet" href="css/app.css">
  </head>
  <body>
    <div class="window" ng-controller="ListController" ng-cloak>
    <header class="toolbar toolbar-header elementary">
      <div class="toolbar-actions">
        <div class="btn-group">
          <button ng-if="settings.soundcloud.active" class="btn btn-default" ng-click="$parent.activeService='soundcloud'" ng-class="{active: $parent.activeService=='soundcloud'}">
            <span class="icon icon-soundcloud"></span>
          </button>
          <button ng-if="settings.GooglePm.active" class="btn btn-default" ng-click="$parent.activeService='GooglePm'" ng-class="{active: $parent.activeService=='GooglePm'}">
            <!--<span class="icon icon-note-beamed"></span>-->
            <!-- WE USE IMG BECAUSE THERE NO APPROPIRATE ICON FOR GOOGLEPM -->
            <img ng-hide="$parent.activeService=='GooglePm'" class="icon-GooglePm" src="img/GooglePm.png"/>
            <img ng-show="$parent.activeService=='GooglePm'" class="icon-GooglePm" src="img/GooglePm_white.png"/>
          </button>
          <button ng-if="settings.local.active" class="btn btn-default" ng-click="$parent.activeService='local'" ng-class="{active: $parent.activeService=='local'}">
            <span class="icon icon-folder"></span>
          </button>
        </div>

        <div class="form-group searchBar">
          <input type="search" ng-change="setSearchActiveTab()" ng-model="search" class="form-control" placeholder="Search for anything ..." ng-model-options="{debounce: 500}">
        </div>

        <button class="btn btn-default pull-right" ng-hide="activeService=='settings'" ng-click="activeService='settings'">
          <span class="icon icon-cog"></span>
          &nbsp;Settings
        </button>

        <button class="btn btn-default pull-right" ng-show="activeService=='settings'" ng-click="saveSettings()">
          <span class="icon icon-check"></span>
          &nbsp;Save
        </button>

      </div>
    </header>

      <div class="window-content">
        <div class="pane-group">
          <div class="pane pane-sm sidebar">

            <nav class="nav-group" ng-if="activeService==='soundcloud'">
              <h5 class="nav-group-title">Main</h5>
              <span class="nav-group-item" ng-click="$parent.activeTab='soundcloudStream'" ng-class="{'active':activeTab==='soundcloudStream'}">
                <span class="icon icon-note-beamed"></span>
                Stream <span ng-show="$parent.playing.source == 'soundcloudStream'" class="icon icon-play playing"></span>
              </span>
              <span class="nav-group-item" ng-click="$parent.activeTab='soundcloudFavs'" ng-class="{'active':activeTab==='soundcloudFavs'}">
                <span class="icon icon-heart"></span>
                Liked tracks <span ng-show="$parent.playing.source == 'soundcloudFavs'" class="icon icon-play playing"></span>
              </span>
              <h5 class="nav-group-title">Playlists</h5>
              <div ng-repeat="playlist in soundcloudPlaylists">
                <span class="nav-group-item" ng-click="$parent.$parent.activeTab='soundcloudPlaylist'+playlist.id" ng-class="{'active':$parent.activeTab==='soundcloudPlaylist'+playlist.id}">
                  <span class="icon icon-list"></span>
                  {{playlist.title}} <span ng-show="$parent.playing.source == 'soundcloudPlaylist'+playlist.id" class="icon icon-play playing"></span>
                </span>
              </div>
            </nav>

            <nav class="nav-group" ng-if="activeService=='GooglePm'">
              <h5 class="nav-group-title">Main</h5>
              <span class="nav-group-item" ng-click="$parent.activeTab='GooglePmAll'" ng-class="{'active':activeTab==='GooglePmAll'}">
                <span class="icon icon-note-beamed"></span>
                All my tracks <span ng-show="$parent.playing.source == 'GooglePmAll'" class="icon icon-play playing"></span>
              </span>
              <span class="nav-group-item" ng-click="$parent.activeTab='GooglePmFavs'" ng-class="{'active':activeTab==='GooglePmFavs'}">
                <span class="icon icon-heart"></span>
                Thumbs up <span ng-show="$parent.playing.source == 'GooglePmFavs'" class="icon icon-play playing"></span>
              </span>
              <h5 class="nav-group-title">Playlists</h5>
              <div ng-repeat="playlist in GooglePmPlaylists">
                <span class="nav-group-item" ng-click="$parent.$parent.activeTab='GooglePmPlaylist'+playlist.id" ng-class="{'active':$parent.activeTab==='GooglePmPlaylist'+playlist.id}">
                  <span class="icon icon-list"></span>
                  {{playlist.title}} <span ng-show="$parent.$parent.playing.source == 'GooglePmPlaylist'+playlist.id" class="icon icon-play playing"></span>
                </span>
              </div>
            </nav>

            <nav class="nav-group" ng-if="activeService=='local'">
              <h5 class="nav-group-title">Main</h5>
              <span class="nav-group-item" ng-click="$parent.activeTab='localAll'" ng-class="{'active':activeTab==='localAll'}">
                <span class="icon icon-note-beamed"></span>
                All my tracks <span ng-show="$parent.playing.source == 'localAll'" class="icon icon-play playing"></span>
              </span>
              <span class="nav-group-item" ng-click="$parent.activeTab='localFavs'" ng-class="{'active':activeTab==='localFavs'}">
                <span class="icon icon-heart"></span>
                Liked tracks <span ng-show="$parent.playing.source == 'localFavs'" class="icon icon-play playing"></span>
              </span>
            </nav>

          </div>

          <div class="pane" ng-if="activeTab=='searchResult'">
            <div ng-show="$parent.settings.soundcloud.active">
              <h2 class="searchTab">From your SoundCloud tracks</h2>
              <table class="table-striped">
                <tr ng-repeat="track in $parent.searchResult | filter:{ service: 'soundcloud'}" ng-mousedown="$parent.$parent.selected = track.id" ng-class="{'selected': $parent.$parent.selected == track.id}" ng-dblclick="playTrack(track)">
                  <td><span ng-show="playing.id == track.id" class="icon icon-play"></span> {{track.title}}</td>
                  <td>{{track.artist}}</td>
                  <td style="width: 30px; padding: 2px 5px">{{track.duration | millSecToDuration}}</td>
                </tr>
              </table>
            </div>
            <div ng-show="$parent.settings.GooglePm.active">
              <h2 class="searchTab">From your Google Play Music tracks</h2>
              <table class="table-striped">
                <tbody>
                  <tr ng-repeat="track in $parent.searchResult | filter:{ service: 'GooglePm' } " ng-mousedown="$parent.$parent.selected = track.id" ng-class="{'selected': $parent.$parent.selected == track.id}" ng-dblclick="playTrack(track)">
                    <td><span ng-show="playing.id == track.id" class="icon icon-play"></span> {{track.title}}</td>
                    <td>{{track.artist}}</td>
                    <td style="width: 30px; padding: 2px 5px">{{track.duration | millSecToDuration}}</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div ng-show="$parent.settings.local.active">
              <h2 class="searchTab">From your local tracks</h2>
              <table class="table-striped">
                <tbody>
                  <tr ng-repeat="track in $parent.searchResult | filter:{ service: 'local' } " ng-mousedown="$parent.$parent.selected = track.id" ng-class="{'selected': $parent.$parent.selected == track.id}" ng-dblclick="playTrack(track)">
                    <td><span ng-show="playing.id == track.id" class="icon icon-play"></span> {{track.title}}</td>
                    <td>{{track.artist}}</td>
                    <td style="width: 30px; padding: 2px 5px">{{track.duration | millSecToDuration}}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="pane" ng-hide="activeTab=='searchResult'">
            <table class="table-striped">
              <thead>
                <tr>
                  <th>Track</th>
                  <th>By</th>
                  <th>Duration</th>
                </tr>
              </thead>
              <tbody>
                <tr ng-repeat="track in trackList()" ng-mousedown="$parent.selected = track.id" ng-class="{'selected': selected == track.id}" ng-dblclick="playTrack(track)">
                  <td><span ng-show="playing.id == track.id" class="icon icon-play"></span> {{track.title}}</td>
                  <td>{{track.artist}}</td>
                  <td style="width: 30px; padding: 2px 5px">{{track.duration | millSecToDuration}}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div id="settings" ng-show="activeService=='settings'">
          <div class="settingsService soundcloud">
            <input type="checkbox" value="None" id="soundcloudActive" ng-model="settings.soundcloud.active"/>
            <label for="soundcloudActive">SoundCloud <span class="error" ng-show="settings.soundcloud.error">Wrong username or password !</span></label>
            <img class="logo" src="img/soundcloud_white.png"/>
            <div ng-show="settings.soundcloud.active">
              <div class="form-group">
                <label>Username</label>
                <input ng-model="settings.soundcloud.user" type="text" class="form-control" placeholder="Username">
              </div>
              <div class="form-group">
                <label>Password</label>
                <input ng-model="settings.soundcloud.passwd" type="password" class="form-control" placeholder="Password">
              </div>
            </div>
          </div>

          <div class="settingsService GooglePm">
            <input type="checkbox" value="None" id="GooglePmActive" ng-model="settings.GooglePm.active"/>
            <label for="GooglePmActive">Google Play Music <span class="error" ng-show="settings.GooglePm.error">Wrong username or password !</span></label>
            <img class="logo" src="img/GooglePm_white.png"/>
            <div ng-show="settings.GooglePm.active">
              <div class="form-group">
                <label>Email</label>
                <input ng-model="settings.GooglePm.user" type="text" class="form-control" placeholder="Email">
              </div>
              <div class="form-group">
                <label>Password</label>
                <input ng-model="settings.GooglePm.passwd" type="password" class="form-control" placeholder="Password">
              </div>
            </div>
          </div>

          <div class="settingsService local">
            <input type="checkbox" value="None" id="localActive" ng-model="settings.local.active"/>
            <label for="localActive">Local music</label>
            <img class="logo" src="img/local_white.png"/>
            <div ng-show="settings.local.active">
              <div class="form-group">
                <label>Path</label>
                <input ng-model="settings.local.path" type="text" class="form-control" placeholder="Path">
              </div>              
            </div>
          </div>
        </div>

        <div class="full_screen" ng-if="loading.state && activeService!=='settings'">
          <div class="spinner">
            <div class="rect1"></div>
            <div class="rect2"></div>
            <div class="rect3"></div>
            <div class="rect4"></div>
            <div class="rect5"></div>
          </div>
        </div>

        <div class="full_screen" ng-if="errorConnection">
          <p>Please check you internet connection</p>
        </div>

        <!-- now player -->
        <div class="player">
            <div class="player_inner">
                <div class="player_progress">
                    <span class="player_progress_bar" id="player-progress"></span>
                </div>
                <div class="player_details">
                    <img id="playerThumb" src="img/blank_artwork.png" onerror="if (this.src != 'img/blank_artwork.png') this.src = 'img/blank_artwork.png';" alt="" class="player_thumb">

                    <h2 id="playerTitle" class="player_title"></h2>
                    <h4 id="playerUser" class="player_user"></h4>

                    <div class="player_time">
                        <span class="player_timeCurrent" id="player-timecurrent"></span>
                        <span class="player_duration" id="player-duration"></span>
                    </div>
                </div>
                <div class="player_controls">
                    <span class="player_prevSong" ng-click="playTrack(getPrevTrack(playing.source, playing.id))">
                        <i class="icon icon-fast-backward thin"></i>
                    </span>
                    <span class="player_play-pause" ng-click="playPause()">
                        <i class="icon" ng-class="{'icon-play': !isSongPlaying, 'icon-pause': isSongPlaying}"></i>
                    </span>
                    <span class="player_nextSong" ng-click="playTrack(getNextTrack(playing.source, playing.id))">
                        <i class="icon icon-fast-forward thin"></i>
                    </span>
                    <span class="player_favorite" ng-class="{'active': playing.favorited}" ng-click="FavPlaying()">
                        <i class="icon icon-heart" ></i>
                    </span>
                </div>
                <audio id="player" controls src="" class="player_currentSong"></audio>
            </div>
        </div>
        <!-- now player / end -->
      </div>
    </div>
  </body>
  <script> window.$ = window.jQuery = require('jquery'); </script>
  <script src="js/app.js"></script>
</html>
